<!DOCTYPE html>
<html lang="pt" prefix="og: https://ogp.me/ns#">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Amo-te Marta (Original)</title>
  <meta name="description" content="Versão original do contador de dias e memórias." />
  <link rel="icon" type="image/svg+xml" href="favicon.svg" />
  <link rel="stylesheet" href="style.css" />
  <meta property="og:title" content="Amo-te Marta" />
  <meta property="og:description" content="Dias juntos e memórias especiais." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="assets/images/IMG_2714.jpg" />
  <style>
    /* Overlay e animações para a sequência de amor (mantém apenas o essencial) */
    .overlay.hidden { display: none; }
    .overlay {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0,0,0,0.6);
      z-index: 999999; /* acima de tudo */
      padding: 20px;
      -webkit-backdrop-filter: blur(6px);
      backdrop-filter: blur(6px);
    }
    .overlay-content {
      background: linear-gradient(180deg,#fff5f8,#fff);
      border-radius: 14px;
      padding: 20px;
      max-width: 520px;
      width: 100%;
      text-align: center;
      box-shadow: 0 12px 40px rgba(0,0,0,0.25);
      position: relative;
    }

    /* Botão 'Amo-te...' — visual de botão, acessível e responsivo */
    .digital-gift-title {
      display: block;
      width: calc(100% - 32px);
      max-width: 520px;
      margin: 10px auto 14px;
      padding: 12px 16px;
      text-align: center;
      color: #c83a6f;
      background: #fff6f8;
      border: 1px solid #ffd7e2;
      border-radius: 12px;
      font-size: 17px;
      font-weight: 700;
      box-shadow: 0 4px 14px rgba(0,0,0,.06);
      cursor: pointer;
      transition: transform .12s ease, box-shadow .2s ease, background-color .2s ease, border-color .2s ease;
      outline: none;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
    }
    .digital-gift-title:hover {
      background: #fff2f6;
      border-color: #ffc8d8;
      box-shadow: 0 6px 18px rgba(0,0,0,.08);
      transform: translateY(-1px);
    }
    .digital-gift-title:active {
      transform: translateY(0);
      box-shadow: 0 3px 10px rgba(0,0,0,.06);
    }
    .digital-gift-title:focus-visible {
      box-shadow: 0 0 0 3px rgba(255,107,143,.35), 0 6px 16px rgba(0,0,0,.08);
    }
    .digital-gift-title.is-busy {
      opacity: .85;
      cursor: default;
      pointer-events: none;
      background: #fff7f9;
      border-color: #ffe2ea;
    }

    /* Forçar a aparecer mesmo que CSS externo esconda */
    .digital-gift { display:block !important; position:relative; z-index:2; }
    .digital-gift-title, .clickable-title { display:block !important; visibility:visible !important; opacity:1 !important; }

    /* Formato do carrossel: altura responsiva e recorte uniforme das fotos */
    .center-image-container { display: flex; justify-content: center; }
    .carousel {
      width: min(92vw, 640px);
      height: clamp(220px, 45vh, 520px);
      position: relative;
      overflow: hidden;
      border-radius: 16px;
      background: #f7f7f7;
      box-shadow: 0 10px 26px rgba(0,0,0,.08);
    }
    .carousel .carousel-image {
      position: absolute; inset: 0;
      width: 100%; height: 100%;
      object-fit: cover;         /* ajusta/recorta a foto */
      object-position: center;   /* centra a foto */
      opacity: 0;
      transition: opacity .35s ease;
      border-radius: inherit;
      will-change: opacity;
      -webkit-user-drag: none; user-select: none;
    }
    .carousel .carousel-image.active { opacity: 1; }

    @media (max-width: 480px) {
      .carousel { height: clamp(220px, 52vw, 380px); border-radius: 12px; }
    }

    @media (prefers-reduced-motion: reduce) {
      .digital-gift-title { transition: none; }
    }

    /* Widget do pintainho (contador flutuante) */
    .duck-counter {
      position: fixed;
      right: 16px;
      bottom: 16px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 12px;
      background: #fff;
      color: #333;
      border: 1px solid #ffd7e2;
      border-radius: 999px;
      box-shadow: 0 8px 22px rgba(200,58,111,.18);
      cursor: pointer;
      user-select: none;
      z-index: 9999;
      font-weight: 700;
      font-size: 15px;
      -webkit-tap-highlight-color: transparent;
    }
    .duck-counter:focus-visible {
      outline: 3px solid rgba(255,107,143,.35);
      outline-offset: 2px;
    }
    .duck-counter:active { transform: translateY(1px); }
    .duck-emoji { font-size: 20px; line-height: 1; }
    .duck-count { min-width: 1.5ch; text-align: right; color: #c83a6f; }

    @media (max-width: 480px) {
      .duck-counter { right: 12px; bottom: 12px; padding: 9px 11px; font-size: 14px; }
      .duck-emoji { font-size: 19px; }
    }

    /* Fix: reduzir espaço entre carrossel e contador no telemóvel */
    @media (max-width: 480px) {
      main.container {
        display: grid !important;
        row-gap: 8px !important;     /* controla o espaço entre secções */
        margin: 0 !important;
        padding: 0 0 8px 0 !important;
      }
      main.container > * {
        margin-top: 0 !important;
        margin-bottom: 0 !important; /* elimina margens dos filhos */
      }
      .center-image-container {
        margin: 0 auto !important;
        padding: 0 !important;
      }
      .carousel {
        margin: 0 !important;
      }
      .counter-container {
        margin: 0 !important;
        padding: 2px 0 0 0 !important; /* encosta ao carrossel */
      }
      .timer {
        margin: 0 !important;
        line-height: 1.15 !important;
      }
    }

    /* Hard override: reduzir o espaço entre carrossel e contador no telemóvel */
    @media (max-width: 480px) {
      /* remove qualquer min-height/padding sobrante */
      .center-image-container,
      .counter-container {
        min-height: 0 !important;
        padding-bottom: 0 !important;
      }

      /* zera margens de todos os envolvidos */
      .center-image-container,
      .carousel,
      .counter-container,
      .counter-container .timer {
        margin-top: 0 !important;
        margin-bottom: 0 !important;
      }

      /* aplica apenas 8px entre o carrossel e o contador */
      .center-image-container + .counter-container {
        margin-top: 8px !important;
      }
    }

    /* Mobile: tornar o carrossel maior e consistente + reduzir espaço até ao contador */
    @media (max-width: 480px) {
      /* largura quase a ecrã inteiro e altura por ratio (mais alto que 52vw) */
      #dynamic-carousel {
        width: 96vw !important;
        max-width: 640px;
        height: auto !important;
        aspect-ratio: 4 / 5;          /* mais alto em telemóvel */
        border-radius: 12px !important;
        margin: 0 auto !important;
      }
      #dynamic-carousel .carousel-image {
        inset: 0;                      /* garante cobertura total */
        object-fit: cover;
        object-position: center;
      }

      .center-image-container {
        width: 100%;
        padding: 0 !important;
        margin: 0 auto !important;
      }
      /* espaço controlado entre carrossel e contador */
      .center-image-container + .counter-container {
        margin-top: 8px !important;
      }
      .counter-container, .timer {
        margin: 0 !important;
        padding: 0 !important;
        line-height: 1.15 !important;
      }
    }

    /* Contador: forçar layout horizontal e evitar quebras */
    .timer {
      display: inline-flex !important;
      align-items: baseline;
      gap: 8px;
      white-space: nowrap; /* tudo na mesma linha */
    }
    .timer > span { display: inline !important; }

    @media (max-width: 480px) {
      .timer { gap: 6px; font-size: 15px; }
    }

    /* Contador: menos espaço entre números e fundo um pouco mais alto */
    .timer {
      gap: 4px !important; /* reduzir no desktop */
    }
    /* Mobile: remover gap e usar pequeno espaçamento após cada número; aumentar altura do fundo */
    @media (max-width: 480px) {
      .timer {
        display: inline-flex !important;
        align-items: center;
        gap: 0 !important;                 /* elimina grandes espaços */
        padding: 12px 16px !important;     /* fundo mais alto/visível */
        border-radius: 14px !important;    /* mantém pílula bonita */
        white-space: nowrap;
      }
      .timer > span {
        display: inline !important;
        margin-right: 6px !important;      /* espaço curto entre número e label */
      }
    }

    /* Deixar o timer mais alto no mobile */
    @media (max-width: 480px) {
      .counter-container .timer {
        padding: 18px 16px !important;   /* altura extra */
        line-height: 1.3 !important;     /* ligeiro aumento da altura da linha */
        border-radius: 16px !important;  /* mantém o formato */
      }
    }

    /* Evitar overflow: no mobile, permitir wrap entre pares e limitar largura */
    @media (max-width: 480px) {
      .counter-container { width: 100% !important; }
      .timer {
        max-width: 100% !important;
        justify-content: center !important;
        flex-wrap: wrap !important;     /* permite 2 linhas se precisar */
        white-space: normal !important;  /* deixa quebrar entre pares */
        column-gap: 8px;                 /* espaço lateral entre pares */
        row-gap: 2px;                    /* espaço vertical se quebrar */
        font-size: clamp(14px, 4vw, 16px);
        padding: 12px 14px !important;   /* fundo um pouco mais alto */
        border-radius: 14px !important;
      }
    }
  </style>
</head>
<body>
  <!-- Container para animação de corações -->
  <div class="hearts-explosion" id="heartsContainer"></div>
  
  <noscript><div style="background:#fff3f7;border:2px solid #ff6f91;padding:10px;border-radius:8px;max-width:400px;margin:10px auto;font-family:Arial,sans-serif;">Este site funciona melhor com JavaScript ativo ❤️</div></noscript>
  <header>
    <h1>Dias Juntos <span aria-hidden="true">❤️</span></h1>
  </header>
  <main class="container">
    <div class="center-image-container">
      <!-- Carrossel -->
      <div class="carousel" role="region" aria-label="Carrossel de fotos" aria-live="polite" id="dynamic-carousel">
        <!-- imagens serão inseridas por script -->
      </div>
    </div>
    <div class="counter-container">
      <div class="timer" role="timer" aria-live="off">
        <!-- manter número + label juntos; permitir quebra entre pares -->
        <span id="days">00</span>&nbsp;dias 
        <span id="hours">00</span>&nbsp;hrs 
        <span id="minutes">00</span>&nbsp;mins 
        <span id="seconds">00</span>&nbsp;secs
      </div>
    </div>
  </main>
  <section class="special-dates">
    <h2>Datas que faço questão de lembrar</h2>
    <div class="dates-container">
      <!-- Ordenadas cronologicamente ao longo do ano -->
      <div class="date-card" data-date="06-29">
        <div class="date-number">29</div>
        <div class="date-month">Junho</div>
        <div class="date-description">Dia que nos conhecemos</div>
      </div>
      <div class="date-card" data-date="07-02">
        <div class="date-number">02</div>
        <div class="date-month">Julho</div>
        <div class="date-description">Primeiro beijo — 14:55</div>
      </div>
      <div class="date-card" data-date="09-15">
        <div class="date-number">15</div>
        <div class="date-month">Setembro</div>
        <div class="date-description">Aniversário do Ivan</div>
      </div>
      <div class="date-card" data-date="10-18">
        <div class="date-number">18</div>
        <div class="date-month">Outubro</div>
        <div class="date-description">Aniversário da Princesa</div>
      </div>
    </div>
  </section>
  <section class="digital-gift">
    <!-- Botão visível/clicável -->
    <div id="digital-gift-btn"
         class="digital-gift-title clickable-title"
         role="button"
         tabindex="0">
      Amo-te Muito Marta/Maria❤️
    </div>
  </section>

  <!-- Inserir overlay/sequence antes do container das páginas de amor -->
  <div id="love-sequence-overlay" class="overlay hidden" role="dialog" aria-modal="true" aria-label="Sequência de amor">
    <div class="overlay-content">
      <button id="seq-skip" class="seq-skip" onclick="skipSequence()" aria-label="Pular sequência">Pular ✕</button>
      <div id="seq-text" class="seq-text" aria-live="polite"></div>
      <div id="seq-extra" style="margin-top:6px;"></div>
    </div>
  </div>

  <!-- Páginas de amor integradas -->
  <div id="love-pages-container" class="love-pages-hidden" aria-hidden="true">
    <div class="notebook-container" role="region" aria-label="Caderno de mensagens">
      <div class="notebook-page" role="document">
        <div class="lined-paper">
          <button class="close-btn" onclick="closeLovePages()" aria-label="Fechar páginas">×</button>
          <div class="holes" aria-hidden="true">
            <div class="hole"></div>
            <div class="hole"></div>
          </div>
          <div class="content" id="page-content" role="article" aria-live="polite" tabindex="0">
            <div style="text-align:center;color:#777;">Carrega em "Amo-te Muito..." para ver as páginas</div>
            <!-- Conteúdo será preenchido dinamicamente -->
          </div>
        </div>
      </div>
      <div class="navigation" role="navigation" aria-label="Navegação de páginas">
        <button onclick="previousPage()" class="nav-btn" id="prev-btn" aria-label="Página anterior" tabindex="0">← Anterior</button>
        <div class="page-counter" id="page-counter" aria-live="polite">1/6</div>
        <button onclick="nextPage()" class="nav-btn" id="next-btn" aria-label="Próxima página" tabindex="0">Próxima →</button>
      </div>
    </div>
  </div>

  <!-- Contador do pintainho: mude data-persist para "false" se quiser que reinicie a cada refresh -->
  <div id="duck-counter" class="duck-counter" role="button" aria-label="Contador do pintainho" tabindex="0" data-persist="true">
    <span class="duck-emoji" aria-hidden="true">🐥</span>
    <span id="duck-count" class="duck-count">0</span>
  </div>

  <script defer src="script.js"></script>
  <script>
    // Animação de explosão de corações ao carregar
    document.addEventListener('DOMContentLoaded', function() {
      setTimeout(() => {
        const heartsContainer = document.getElementById('heartsContainer');
        
        // Criar 30 corações
        for (let i = 0; i < 30; i++) {
          const heart = document.createElement('div');
          heart.className = 'heart';
          heart.innerHTML = '❤️';
          
          // Posição aleatória na largura da tela
          heart.style.left = Math.random() * 90 + '%';
          heart.style.bottom = '0px';
          
          // Delay aleatório para cada coração
          heart.style.animationDelay = (Math.random() * 1.5) + 's';
          
          // Adicionar ao container
          heartsContainer.appendChild(heart);
        }
        
        // Remover container após animação
        setTimeout(() => {
          heartsContainer.remove();
        }, 5000);
      }, 500);
    });

    // Contador dinâmico: inicia em 29 de Junho do ano apropriado
    document.addEventListener('DOMContentLoaded', function () {
      const now = new Date();
      // 29 de Junho do ano corrente (mes é 5 porque janeiro = 0)
      let startDate = new Date(now.getFullYear(), 5, 29, 0, 0, 0);
      // Se 29/06 deste ano ainda não ocorreu, usa 29/06 do ano anterior
      if (startDate > now) {
        startDate = new Date(now.getFullYear() - 1, 5, 29, 0, 0, 0);
      }

      function updateCounter() {
        const now = new Date();
        let diff = now - startDate;
        if (diff < 0) diff = 0;

        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        diff -= days * (1000 * 60 * 60 * 24);
        const hours = Math.floor(diff / (1000 * 60 * 60));
        diff -= hours * (1000 * 60 * 60);
        const minutes = Math.floor(diff / (1000 * 60));
        diff -= minutes * (1000 * 60);
        const seconds = Math.floor(diff / 1000);

        const el = id => document.getElementById(id);
        if (el('days')) el('days').textContent = String(days).padStart(2, '0');
        if (el('hours')) el('hours').textContent = String(hours).padStart(2, '0');
        if (el('minutes')) el('minutes').textContent = String(minutes).padStart(2, '0');
        if (el('seconds')) el('seconds').textContent = String(seconds).padStart(2, '0');
      }

      updateCounter();
      setInterval(updateCounter, 1000);
    });
  </script>

  <!-- ...existing code de validação de vídeos... -->

  <script>
    (function(){
      let seqState = { running: false, skipped: false, currentPage: 0, pages: [] };
      const fakeNumber = 36;
      const targetPhrase = "Amo-te muito Marta/Maria";

      function setSeqHTML(html) {
        const el = document.getElementById('seq-text');
        if (el) el.innerHTML = html;
      }
      function showOverlay() {
        seqState.skipped = false;
        seqState.running = true;
        const overlay = document.getElementById('love-sequence-overlay');
        if (overlay) {
          overlay.classList.remove('hidden');
          overlay.style.display = 'flex';
          overlay.setAttribute('aria-hidden','false');
        }
      }
      function hideOverlay() {
        const overlay = document.getElementById('love-sequence-overlay');
        if (overlay) {
          overlay.classList.add('hidden');
          overlay.style.display = '';
          overlay.setAttribute('aria-hidden','true');
        }
        seqState.running = false;
      }
      window.skipSequence = function() {
        seqState.skipped = true;
      };

      function typeText(text, speed=40) {
        return new Promise(resolve=>{
          const el = document.getElementById('seq-text');
          if (!el) return resolve();
          el.textContent = '';
          let i = 0;
          (function step(){
            if (seqState.skipped) { el.textContent = text; return resolve(); }
            if (i < text.length) {
              el.textContent += text[i++];
              setTimeout(step, speed);
            } else {
              setTimeout(resolve, 500);
            }
          })();
        });
      }
      function eraseText(speed=24) {
        return new Promise(resolve=>{
          const el = document.getElementById('seq-text');
          if (!el) return resolve();
          let txt = el.textContent;
          let i = txt.length;
          (function step(){
            if (seqState.skipped) { el.textContent = ''; return resolve(); }
            if (i > 0) {
              i--;
              el.textContent = txt.slice(0,i);
              setTimeout(step, speed);
            } else resolve();
          })();
        });
      }
      async function showLines(lines) {
        const container = document.getElementById('seq-extra');
        container.innerHTML = '';
        for (let i=0;i<lines.length;i++) {
          if (seqState.skipped) {
            container.innerHTML = lines.map(l=>`<div class="seq-line show">${l}</div>`).join('');
            return;
          }
          const div = document.createElement('div');
          div.className = 'seq-line';
          div.textContent = lines[i];
          container.appendChild(div);
          requestAnimationFrame(()=> div.classList.add('show'));
          await new Promise(r=>setTimeout(r, 700));
        }
      }

      function populatePagesWithRepeats(count) {
        const perPage = 6; // linhas por página
        const pages = [];
        for (let i=0;i<count;i+=perPage) {
          const chunk = [];
          for (let j=0;j<perPage && (i+j)<count; j++) {
            chunk.push(`<div style="padding:8px 0;font-size:18px;color:#c83a6f;font-weight:600;text-align:center;">${targetPhrase}</div>`);
          }
          pages.push(`<div class="page-block">${chunk.join('')}</div>`);
        }
        seqState.pages = pages;
        seqState.currentPage = 0;
        showPage(0);
      }

      function showPage(idx) {
        const pc = document.getElementById('page-content');
        const counter = document.getElementById('page-counter');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        if (!pc) return;
        pc.innerHTML = seqState.pages[idx] || '<div style="text-align:center;color:#777;">Sem conteúdo</div>';
        seqState.currentPage = idx;
        if (counter) counter.textContent = `${idx+1}/${Math.max(1, seqState.pages.length)}`;
        if (prevBtn) prevBtn.disabled = idx <= 0;
        if (nextBtn) nextBtn.disabled = idx >= seqState.pages.length - 1;
        setTimeout(()=> {
          const container = document.getElementById('love-pages-container');
          if (container) container.scrollIntoView({behavior:'smooth', block:'center'});
        }, 120);
      }

      // Navegação/fecho
      window.previousPage = window.previousPage || function() {
        if (seqState.currentPage > 0) { seqState.currentPage--; showPage(seqState.currentPage); }
      };
      window.nextPage = window.nextPage || function() {
        if (seqState.currentPage < seqState.pages.length - 1) { seqState.currentPage++; showPage(seqState.currentPage); }
      };
      window.closeLovePages = window.closeLovePages || function() {
        const c = document.getElementById('love-pages-container');
        if (c) { c.classList.add('love-pages-hidden'); c.setAttribute('aria-hidden','true'); }
      };

      // Sequência pedida: pergunta -> número fictício -> comparações -> mensagem fofa -> abrir páginas
      window.runSequence = async function() {
        if (seqState.running) return;
        showOverlay();
        await new Promise(r => setTimeout(r, 150)); // garantir render do overlay
        // 1) Pergunta
        await typeText('Sabes quantas vezes disseste "Amo-te Muito Ivan"?', 40);
        if (seqState.skipped) { hideOverlay(); return; }
        await new Promise(r=>setTimeout(r, 450));
        await eraseText(24);
        if (seqState.skipped) { hideOverlay(); return; }
        // 2) Número fictício
        setSeqHTML(`<span class="seq-number" aria-live="polite">${fakeNumber}</span><div style="font-size:12px;color:#666;margin-top:6px;">vezes</div>`);
        const numEl = document.querySelector('.seq-number');
        if (numEl) numEl.animate([{ transform: 'scale(0.6)' }, { transform: 'scale(1.08)' }, { transform: 'scale(1)' }], { duration: 700, easing:'cubic-bezier(.2,.8,.2,1)' });
        await new Promise(r=>setTimeout(r, 900));
        if (seqState.skipped) { hideOverlay(); return; }
        // 3) Comparações (3 linhas)
        await showLines([
          "Mais doce que chocolate quente num dia frio.",
          "Mais brilhante que a primeira estrela da noite.",
          "Mais calma que um abraço ao fim do dia."
        ]);
        await new Promise(r=>setTimeout(r, 800));
        if (seqState.skipped) { hideOverlay(); return; }
        // 4) Mensagem fofa
        setSeqHTML(`<div style="font-weight:700;color:#c83a6f;">És o meu sorriso diário 💕</div>`);
        await new Promise(r=>setTimeout(r, 1000));
        // 5) Preparar e abrir páginas
        populatePagesWithRepeats(fakeNumber);
        hideOverlay();
        const container = document.getElementById('love-pages-container');
        if (container) {
          container.classList.remove('love-pages-hidden');
          container.setAttribute('aria-hidden','false');
          if (window.innerWidth <= 480) {
            setTimeout(()=> container.scrollIntoView({behavior:'smooth', block:'start'}), 80);
          }
        }
      };

      // Alias novo e explícito para iniciar sequência (evita conflitos)
      window.openSequenceEntry = function() { runSequence(); };

      // Garantir botão visível e acessível
      document.addEventListener('DOMContentLoaded', function() {
        const btn = document.getElementById('digital-gift-btn');
        if (!btn) return;
        btn.style.display = 'block';
        btn.style.visibility = 'visible';
        btn.style.opacity = '1';
        btn.style.pointerEvents = 'auto';
        if (!btn.hasAttribute('role')) btn.setAttribute('role','button');
        if (!btn.hasAttribute('tabindex')) btn.setAttribute('tabindex','0');
        // Listener em captura: impede qualquer outro handler de abrir o caderno diretamente
        btn.addEventListener('click', function(e){
          e.preventDefault(); e.stopPropagation(); e.stopImmediatePropagation();
          window.openSequenceEntry();
        }, { capture: true });
        btn.addEventListener('keydown', function(e) {
          if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); window.openSequenceEntry(); }
        });
      });
    })();
  </script>

  <!-- Guard: se o botão for removido/ocultado por outro script/CSS, recria e mantém visível -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      function attachBtnHandlers(btn){
        // limpar onclick legado, se existir
        try { btn.onclick = null; } catch(_) {}
        btn.addEventListener('click', function(e){
          e.preventDefault(); e.stopPropagation(); e.stopImmediatePropagation();
          if (typeof window.openSequenceEntry === 'function') window.openSequenceEntry();
        }, { capture: true });
        btn.addEventListener('keydown', function(e){
          if (e.key==='Enter' || e.key===' ') {
            e.preventDefault();
            if (typeof window.openSequenceEntry === 'function') window.openSequenceEntry();
          }
        });
      }
      function ensureBtn() {
        let btn = document.getElementById('digital-gift-btn');
        if (!btn) {
          const sec = document.querySelector('section.digital-gift') || document.body;
          btn = document.createElement('div');
          btn.id = 'digital-gift-btn';
          btn.className = 'digital-gift-title clickable-title';
          btn.setAttribute('role','button');
          btn.setAttribute('tabindex','0');
          btn.textContent = 'Amo-te Muito Marta/Maria❤️';
          sec.appendChild(btn);
        }
        // forçar visibilidade
        btn.style.display = 'block';
        btn.style.visibility = 'visible';
        btn.style.opacity = '1';
        btn.style.pointerEvents = 'auto';
        attachBtnHandlers(btn);
      }
      ensureBtn();
      // observar remoções/alterações no DOM e repor o botão caso desapareça
      new MutationObserver(ensureBtn).observe(document.body, { childList: true, subtree: true });
    });
  </script>

  <!-- script para popular o carrossel -->
  <script>
    (function(){
      // Lista de imagens estáticas
      const images = [
        'assets/images/IMG_2714.jpg',
        'assets/images/WhatsApp Image 2025-10-26 at 23.23.42.jpeg',
        'assets/images/WhatsApp Image 2025-10-26 at 23.23.43 (2).jpeg',
        'assets/images/WhatsApp Image 2025-10-26 at 23.23.43 (3).jpeg',
        'assets/images/WhatsApp Image 2025-10-26 at 23.23.43.jpeg',
        'assets/images/WhatsApp Image 2025-10-26 at 23.23.46 (1).jpeg',
        'assets/images/WhatsApp Image 2025-10-26 at 23.23.46 (2).jpeg',
        'assets/images/WhatsApp Image 2025-10-26 at 23.23.46 (3).jpeg',
        'assets/images/WhatsApp Image 2025-10-26 at 23.23.46.jpeg'
      ];

      const carousel = document.getElementById('dynamic-carousel');
      if (!carousel) return;

      images.forEach((src, idx) => {
        const img = document.createElement('img');
        img.src = src;
        img.alt = `Momentos felizes ${idx+1}`;
        img.className = 'center-image carousel-image' + (idx === 0 ? ' active' : '');
        img.loading = idx === 0 ? 'eager' : 'lazy';
        img.decoding = 'async';
        img.setAttribute('fetchpriority', idx === 0 ? 'high' : 'low');
        carousel.appendChild(img);
      });
    })();
  </script>

  <!-- Lógica do contador do pato (sem base de dados; usa localStorage opcionalmente) -->
  <script>
    (function(){
      document.addEventListener('DOMContentLoaded', function(){
        const widget = document.getElementById('duck-counter');
        if (!widget) return;

        const countEl = document.getElementById('duck-count');
        const persist = (widget.getAttribute('data-persist') || 'true') === 'true';
        const KEY = 'duckCounter:v1';

        let count = 0;
        if (persist) {
          const saved = localStorage.getItem(KEY);
          count = saved ? (parseInt(saved, 10) || 0) : 0;
        }

        function render() { countEl.textContent = String(count); }
        function bump() {
          count++;
          if (persist) localStorage.setItem(KEY, String(count));
          render();
          try {
            widget.animate(
              [{ transform: 'scale(1)' }, { transform: 'scale(1.06)' }, { transform: 'scale(1)' }],
              { duration: 180, easing: 'ease-out' }
            );
          } catch(_) {}
        }

        render();
        widget.addEventListener('click', e => { e.preventDefault(); bump(); });
        widget.addEventListener('keydown', e => {
          if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); bump(); }
        });

        // Reset rápido com botão direito (opcional)
        widget.addEventListener('contextmenu', e => {
          e.preventDefault();
          count = 0;
          if (persist) localStorage.setItem(KEY, '0');
          render();
        });
      });
    })();
  </script>
</body>
</html>